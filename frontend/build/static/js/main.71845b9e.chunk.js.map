{"version":3,"sources":["helpers/history.ts","components/home.tsx","helpers/client.ts","helpers/index.ts","components/play.tsx","helpers/hooks.ts","components/browse.tsx","components/dashboard.tsx","components/content.tsx","serviceWorker.ts","app.tsx","index.tsx"],"names":["addHistoryItem","value","items","getHistoryItems","localStorage","setItem","JSON","stringify","filter","v","link","slice","str","getItem","parse","HomeComponent","useState","input","setInput","historyItems","setHistoryItems","history","useHistory","className","name","placeholder","onChange","event","target","onClick","trim","push","encodeURIComponent","length","map","item","style","whiteSpace","to","removeHistoryItem","apiDomain","window","location","protocol","host","streamUrl","apiKey","modalActive","modalQueue","request","path","options","a","retry","fetch","headers","authorization","then","handleResponse","response","ok","status","Promise","resolve","reject","catch","modal","document","getElementById","form","backdrop","HTMLElement","HTMLFormElement","HTMLInputElement","body","classList","add","display","addEventListener","callback","preventDefault","removeEventListener","remove","forEach","cb","json","error","String","Error","createTorrent","method","getSteamUrl","file","getProviders","searchTorrents","provider","query","category","params","URLSearchParams","q","c","p","toString","formatBytes","bytes","decimals","k","dm","sizes","i","Math","floor","log","parseFloat","pow","toFixed","PlayComponent","torrent","setTorrent","setError","useLocation","searchParams","search","get","useEffect","newTorrent","action","err","role","href","arr","key","order","sorted","sort","b","doCompare","keyA","keyB","Array","res","Object","values","stringA","toLowerCase","stringB","reverse","sortBy","files","split","part","index","width","controls","src","type","useSearchParam","useContext","__RouterContext","useMemo","BrowseComponent","loading","setLoading","providers","setProviders","torrents","setTorrents","handler","args","replace","delete","set","entries","useSearchParamsHandler","doAction","canSearch","providerNames","categories","find","Container","Form","onSubmit","formQuery","FormData","Row","Col","sm","FormControl","as","disabled","vi","subcategories","label","id","s","si","InputGroup","defaultValue","Append","Button","variant","xmlns","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","Alert","Table","ti","size","time","seeds","points","peers","downloads","d","magnet","DashboardComponent","usage","setUsage","updateTorrents","getTorrents","updateUsage","getUsage","torrentsInterval","usageInterval","setInterval","clearInterval","totalDiskSpace","freeDiskSpace","usedTorrentSpace","downloaded","downloadSpeed","format","started","ContentComponent","rel","component","exact","isLocalhost","Boolean","hostname","match","register","config","navigator","URL","process","origin","swUrl","contentType","indexOf","serviceWorker","ready","registration","unregister","reload","registerValidSW","console","checkValidServiceWorker","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","div","createElement","position","bottom","left","right","zIndex","textAlign","background","padding","innerHTML","appendChild","ReactDOM","render"],"mappings":"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","file":"static/js/main.71845b9e.chunk.js","sourcesContent":["export interface HistoryItem {\n    name: string\n    link: string\n}\n\nexport const historyKey = 'torrentsHistory'\nexport const historyLimit = 10\n\nexport function addHistoryItem(value: HistoryItem): void {\n    const items = getHistoryItems()\n    localStorage.setItem(historyKey, JSON.stringify([\n        value,\n        ...items.filter(v => v.link !== value.link)\n    ].slice(0, historyLimit)))\n}\n\nexport function removeHistoryItem(value: HistoryItem): void {\n    const items = getHistoryItems()\n    localStorage.setItem(historyKey, JSON.stringify(\n        items.filter(v => v.link !== value.link)\n    ))\n}\n\nexport function getHistoryItems(): HistoryItem[] {\n    const str = localStorage.getItem(historyKey)\n    try {\n        return str ? JSON.parse(str) : []\n    } catch {\n        return []\n    }\n}","import React, { useState } from 'react'\nimport { useHistory, Link } from 'react-router-dom'\nimport { getHistoryItems, removeHistoryItem } from '../helpers/history'\n\nexport function HomeComponent(): JSX.Element {\n    const [input, setInput] = useState('')\n    const [historyItems, setHistoryItems] = useState(getHistoryItems())\n    const history = useHistory()\n\n\n    return <div className=\"container\">\n        <h2 className=\"mt-5\">Create video stream</h2>\n        <div className=\"form-group\">\n            <input className=\"form-control\" name=\"link\" placeholder=\"Torrent file or magnet link\" value={input} onChange={event => {\n                setInput(event.target.value)\n            }}/>\n        </div>\n        <button className=\"btn btn-outline-primary\" onClick={() => {\n            if (input.trim()) {\n                history.push(`/play?torrent=${encodeURIComponent(input)}`)\n            }\n        }}>Load video</button>\n        {historyItems.length > 0 && <>\n            <h2 className=\"mt-5\">History</h2>\n            <table className=\"table\">\n                <tbody>\n                    {historyItems.map(item => <>\n                        <tr>\n                            <td>{item.name}</td>\n                            <td style={{whiteSpace: 'nowrap'}}>\n                                <Link to={`/play?torrent=${encodeURIComponent(item.link)}`} className=\"btn btn-outline-primary ti-control-play\"></Link>\n                                <button className=\"btn btn-outline-danger ti-close ml-1\" onClick={() => {\n                                    removeHistoryItem(item)\n                                    setHistoryItems(getHistoryItems())\n                                }}></button>\n                            </td>\n                        </tr>\n                    </>)}\n                </tbody>\n            </table>\n        </>}\n    </div>\n}\n","export interface TorrentMeta {\n    link: string\n    infoHash: string\n    name: string\n    started: number\n    updated: number\n    files: {\n        name: string\n        path: string\n        length: number\n    }[]\n    downloaded: number\n    downloadSpeed: number\n}\n\nexport interface Usage {\n    totalDiskSpace: number,\n    freeDiskSpace: number,\n    usedTorrentSpace: number,\n}\n\nconst apiDomain = process.env.NODE_ENV === 'production' ? `${window.location.protocol}//${window.location.host}` : 'http://127.0.0.1:3000' \nconst streamUrl = `${apiDomain}/stream`\n\nlet apiKey = ''\nlet modalActive = false\nconst modalQueue: Array<() => void> = []\n\nasync function request(path: string, options?: RequestInit): Promise<Response> {\n    const retry = () => {\n        return fetch(`${apiDomain}/${path}`, {\n            ...(apiKey ? {\n                headers: {\n                    authorization: `bearer ${apiKey}`,\n                    ...(options || {}).headers\n                }\n            } : {}),\n            ...options\n        })\n    }\n    return retry().then(v => handleResponse(v, retry))\n}\n\nasync function handleResponse(response: Response, retry: () => Promise<Response>): Promise<Response> {\n    if (!response.ok) {\n        if (response.status === 403) {\n            if (modalActive) {\n                return new Promise((resolve, reject) => {\n                    modalQueue.push(() => {\n                        retry().then(v => resolve(handleResponse(v, retry))).catch(reject)\n                    })\n                })\n            } else {\n                modalActive = true\n                return new Promise((resolve, reject) => {\n                    const modal = document.getElementById('authorization_modal')\n                    const form = document.getElementById('authorization_form')\n                    const input = document.getElementById('authorization_input')\n                    const backdrop = document.getElementById('backdrop') \n                    if (modal instanceof HTMLElement && form instanceof HTMLFormElement && input instanceof HTMLInputElement && backdrop) {\n                        document.body.classList.add('modal-open')\n                        modal.style.display = 'block'\n                        backdrop.style.display = 'block'\n\n                        const callback = (event: Event) => {\n                            event.preventDefault()\n                            if (input.value) {\n                                apiKey = input.value\n                                form.removeEventListener('submit', callback)\n                                document.body.classList.remove('modal-open')\n                                modal.style.display = ''\n                                backdrop.style.display = 'none'\n                                modalActive = false\n                                retry().then(async v => {\n                                    resolve(handleResponse(v, retry))\n                                    modalQueue.forEach(cb => {\n                                        cb()\n                                    })\n                                }).catch(reject)\n                            }\n                        }\n\n                        form.addEventListener('submit', callback)\n                    }\n                    // resolve(retry())\n                })\n            }\n        }\n        let error: string\n        try {\n            error = (await response.json()).error\n        } catch (err) {\n            error = String(err)\n        }\n        throw Error(error) || 'Bad response'\n    }\n    return response\n}\n\n\nexport async function createTorrent({ link }: { link: string }): Promise<TorrentMeta> {\n    return request(`api/torrents?torrent=${link}`, {\n        method: 'POST'\n    }).then(v => v.json())\n}\n\nexport async function getTorrents(): Promise<TorrentMeta[]> {\n    return request(`api/torrents`).then(v => v.json())\n}\n\nexport function getSteamUrl(link: string, file: string): string {\n    return `${streamUrl}?torrent=${encodeURIComponent(link)}&file=${encodeURIComponent(file)}`\n}\n\nexport async function getUsage(): Promise<Usage> {\n    return request(`api/usage`).then(v => v.json())\n}\n\nexport interface BrowseTorrent {\n    name: string\n    magnet: string\n    seeds?: number\n    peers?: number\n    downloads?: number\n    size: string\n    time: string\n}\n\nexport interface BrowseProvider {\n    name: string\n    categories: {\n        name: string\n        id: string\n        subcategories: {\n            name: string\n            id: string\n        }[]\n    }[]\n    features: string[]\n}\n\nexport async function getProviders(): Promise<BrowseProvider[]> {\n    return request(`api/browse/providers`, {\n        method: 'GET'\n    }).then(v => v.json())\n}\n\nexport async function searchTorrents(provider: string, query: string, category: string): Promise<BrowseTorrent[]> {\n    const params = new URLSearchParams({\n        q: query,\n        c: category,\n        p: provider\n    })\n    return request(`api/browse/search?${params.toString()}`, {\n        method: 'GET'\n    }).then(v => v.json())\n}\n","export function formatBytes(bytes: number, decimals: number = 2): string {\n    if (bytes === 0) return '0 Bytes'\n\n    const k = 1024\n    const dm = decimals < 0 ? 0 : decimals\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\n\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i]\n}\n\nexport function sortBy<T>(arr: T[], key: (item: T) => unknown = v => v, order: 'asc' | 'desc' = 'asc'): T[] {\n    const sorted = [...arr].sort((a, b) => {\n        const doCompare = (keyA: unknown, keyB: unknown): number => {\n            if (typeof keyA === 'number' && typeof keyB === 'number') {\n                return keyA < keyB ? -1 : keyA > keyB ? 1 : 0\n            }\n\n            if (keyA instanceof Array && keyB instanceof Array) {\n                const res = keyA.map((v, i) => doCompare(v, keyB[i])).filter(v => v !== 0)\n                return res.length ? res[0] : 1\n            }\n\n            if (typeof keyA === 'object' && typeof keyB === 'object') {\n                return doCompare(Object.values(keyA ?? {})[0], Object.values(keyB ?? {})[0])\n            }\n\n            const stringA = String(keyA).toLowerCase()\n            const stringB = String(keyB).toLowerCase()\n\n            return stringA < stringB ? -1 : stringA > stringB ? 1 : 0\n        }\n\n        return doCompare(key(a), key(b))\n    })\n    return order === 'desc' ? sorted.reverse() : sorted\n}\n","import React, { useEffect, useState } from 'react'\nimport { useLocation, Link } from 'react-router-dom'\n\nimport { TorrentMeta, createTorrent, getSteamUrl } from '../helpers/client'\nimport { formatBytes, sortBy } from '../helpers'\nimport { addHistoryItem } from '../helpers/history'\n\nexport function PlayComponent(): JSX.Element {\n    const [torrent, setTorrent] = useState<TorrentMeta>()\n    const [error, setError] = useState('')\n    const location = useLocation()\n\n    const searchParams = new URLSearchParams(location.search)\n    const link = searchParams.get('torrent')\n    const file = searchParams.get('file')\n\n    useEffect(() => {\n        const action = async () => {\n            if (link) {\n                const newTorrent = await createTorrent({ link })\n                setTorrent(newTorrent)\n                addHistoryItem({\n                    name: newTorrent.name,\n                    link: newTorrent.link,\n                })\n            } else {\n                setError('Torrent link is not specified')\n            }\n        }\n        action().catch(err => {\n            setError(String(err))\n        })\n    }, [link])\n\n    return <div className=\"container\">\n        {error && <div className=\"alert alert-danger\" role=\"alert\">\n            {error}\n        </div>}\n        {!torrent && !error && <div className=\"text-center\">\n            <div className=\"spinner-border\" role=\"status\">\n                <span className=\"sr-only\">Loading...</span>\n            </div>\n        </div>}\n        {torrent && link && <>\n            <h3><small>{torrent.name}</small></h3>\n            {!file ? <table className=\"table\">\n                <thead>\n                    <tr>\n                        <th>File</th>\n                        <th>Size</th>\n                        <th>Play</th>\n                        <th>Link</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {sortBy(torrent.files, v => v.name).map(v => <tr>\n                        <td>\n                            {v.path.split('/').map((part, index, arr) => index + 1 < arr.length ? <span className='text-muted'>{part} / </span>: part)}\n                        </td>\n                        <td>\n                            {formatBytes(v.length)}\n                        </td>\n                        <td>\n                            <Link to={`?torrent=${encodeURIComponent(link)}&file=${encodeURIComponent(v.path)}`} className=\"btn btn-outline-primary ti-control-play\"></Link>\n                        </td>\n                        <td>\n                            <a href={getSteamUrl(link, v.path)} className=\"btn btn-outline-primary ti-cloud-down\">{' '}</a>\n                        </td>\n                    </tr>)}\n                </tbody>\n            </table> : <>\n                <h5 className=\"text-muted\"><small>{file}</small><a href={`${getSteamUrl(link, file)}`} className=\"btn ti-cloud-down text-primary\">{' '}</a> - <Link to={`?torrent=${encodeURIComponent(link)}`}>view all</Link></h5>\n            </>}\n            {file && link && <>\n                <div className=\"embed-responsive embed-responsive-16by9\">\n                    <video width=\"720\" controls>\n                        <source src={getSteamUrl(link, file)} type=\"video/mp4\" />\n                        Your browser does not support HTML5 video.\n                    </video>\n                </div>\n                <br />\n                <div className=\"form-group\">\n                    <input className=\"form-control\" value={getSteamUrl(link, file)} />\n                </div>\n            </>}\n        </>}\n    </div>\n}\n","import { useMemo, useContext } from 'react'\nimport { __RouterContext } from 'react-router'\n\nexport function useSearchParam<T extends string>(key: string): T | undefined {\n    const { location } = useContext(__RouterContext)\n    const params = useMemo(() => new URLSearchParams(location.search), [location.search])\n\n    return params.get(key) as T\n}\n\nexport function useSearchParamsHandler() {\n    const { location, history } = useContext(__RouterContext)\n\n    return (args: { set?: Record<string, string>; delete?: readonly string[] }, replace: boolean = false) => {\n        const params = new URLSearchParams(location.search)\n        if (args.delete) {\n            args.delete.forEach((v) => {\n                params.delete(v)\n            })\n        }\n        if (args.set) {\n            Object.entries(args.set).forEach(([k, v]) => {\n                if (v) {\n                    params.set(k, v)\n                } else {\n                    params.delete(k)\n                }\n            })\n        }\n        if (replace) {\n            history.replace({\n                search: params.toString().replace(encodeURIComponent(':'), ':'),\n            })\n        } else {\n            history.push({\n                search: params.toString().replace(encodeURIComponent(':'), ':'),\n            })\n        }\n    }\n}\n","import React, { useState, useEffect, Fragment } from 'react'\nimport { Container, Row, Col, FormControl, Alert, Button, InputGroup, Form, Table } from 'react-bootstrap'\nimport { getProviders, BrowseProvider, BrowseTorrent, searchTorrents } from '../helpers/client'\nimport { useSearchParam, useSearchParamsHandler } from '../helpers/hooks'\nimport { Link } from 'react-router-dom'\n\nexport function BrowseComponent(): JSX.Element {\n    const [error, setError] = useState('')\n    const [loading, setLoading] = useState(false)\n\n    const [providers, setProviders] = useState<BrowseProvider[]>([])\n    const [torrents, setTorrents] = useState<BrowseTorrent[]>()\n\n    const handler = useSearchParamsHandler()\n    const provider = useSearchParam('provider') ?? ''\n    const category = useSearchParam('category') ?? ''\n    const query = useSearchParam('query') ?? ''\n\n    useEffect(() => {\n        const doAction = async () => {\n            setProviders(await getProviders())\n        }\n        doAction().catch(err => setError(String(err)))\n    }, [])\n\n    const canSearch = provider && query\n\n    useEffect(() => {\n        const doAction = async () => {\n            setError('')\n            if (canSearch) {\n                try {\n                    setLoading(true)\n                    setTorrents(await searchTorrents(provider, query, category))\n                } finally {\n                    setLoading(false)\n                }\n            }\n        }\n        doAction().catch(err => setError(String(err)))\n    }, [provider, query, category, canSearch])\n\n    const providerNames = providers.map(v => v.name).sort()\n    const categories = provider ? providers.find(v => v.name === provider)?.categories ?? [] : []\n\n    return <Container>\n        <Form onSubmit={event => {\n            event.preventDefault()\n            const formQuery = new FormData(event.target as HTMLFormElement).get('query') \n            handler({\n                set: {\n                    query: typeof formQuery === 'string' ? formQuery : ''\n                }\n            })\n        }}>\n            <Row>\n                <Col sm className=\"mt-2\">\n                    <Row>\n                        <Col>\n                            <FormControl as=\"select\" value={provider} onChange={event => {\n                                handler({\n                                    set: {\n                                        provider: event.target.value\n                                    },\n                                    delete: ['category', 'query']\n                                })\n                            }}>\n                                <option value=\"\">-- select provider --</option>\n                                {providerNames.map(v => <option key={v} value={v}>{v}</option>)}\n                            </FormControl>\n                        </Col>\n                        <Col>\n                            <FormControl as=\"select\" value={category} onChange={event => {\n                                handler({\n                                    set: {\n                                        category: event.target.value\n                                    },\n                                    delete: ['query']\n                                })\n                            }} disabled={!provider}>\n                                <option value=\"\">All categories</option>\n                                {categories.map((v, vi) => <Fragment key={vi}>\n                                    {v.subcategories.length > 0 ? <>\n                                        <optgroup label={v.name}>\n                                            <option value={v.id}>All {v.name}</option>\n                                            {v.subcategories.map((s, si) => <option value={s.id} key={si}>{s.name}</option>)}\n                                        </optgroup>\n                                    </> : <>\n                                        <option value={v.id}>{v.name}</option>\n                                    </>}\n                                </Fragment>)}\n                            </FormControl>\n                        </Col>\n                    </Row>\n                </Col>\n                <Col sm className=\"mt-2\">\n                    <InputGroup>\n                        <FormControl disabled={!provider} defaultValue={query} type=\"search\" placeholder=\"Search...\" name=\"query\"/>\n                        <InputGroup.Append>\n                            <Button\n                                disabled={!provider}\n                                variant=\"outline-primary\"\n                                type=\"submit\"\n                            ><svg xmlns=\"http://www.w3.org/2000/svg\" width={24} height={24} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"feather feather-search\"><circle cx={11} cy={11} r={8} /><line x1={21} y1={21} x2=\"16.65\" y2=\"16.65\" /></svg></Button>\n                        </InputGroup.Append>\n                    </InputGroup>\n                </Col>\n            </Row>\n        </Form>\n        {error && <Alert variant=\"danger\" className=\"mt-5\">\n            {error}\n        </Alert>}\n        {loading && <div className=\"d-flex justify-content-center mt-5\">\n            <div className=\"spinner-border\" role=\"status\">\n                <span className=\"sr-only\">Loading...</span>\n            </div>\n        </div>}\n        {!loading && torrents?.length === 0 && canSearch && <Alert variant=\"info\" className=\"mt-5\">\n            No results were found\n        </Alert>}\n        {!loading && <Table className=\"mt-3\">\n            <tbody>\n                {torrents?.map((torrent, ti) => <>\n                    <tr key={ti}>\n                        <td>{torrent.name}</td>\n                        <td className=\"text-right\" style={{whiteSpace: 'nowrap'}}>{torrent.size}</td>\n                        <td className=\"text-right\" style={{whiteSpace: 'nowrap'}}>\n                            {torrent.time}\n                        </td>\n                        <td className=\"text-right\" style={{whiteSpace: 'nowrap'}}>\n                            {torrent.seeds != null && <span className=\"text-success\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width={16} height={16} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"feather feather-arrow-up\"><line x1={12} y1={19} x2={12} y2={5} /><polyline points=\"5 12 12 5 19 12\" /></svg>\n                                {torrent.seeds}\n                            </span>}\n                            {' '}\n                            {torrent.peers != null && <span className=\"text-danger\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width={16} height={16} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"feather feather-arrow-down\"><line x1={12} y1={5} x2={12} y2={19} /><polyline points=\"19 12 12 19 5 12\" /></svg>\n                                {torrent.peers}\n                            </span>}\n                            {' '}\n                        </td>\n                        <td className=\"text-right\" style={{whiteSpace: 'nowrap'}}>\n                            {torrent.downloads != null && <span>\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width={16} height={16} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"feather feather-download\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"7 10 12 15 17 10\" /><line x1={12} y1={15} x2={12} y2={3} /></svg>\n                                {torrent.downloads}\n                            </span>}\n                        </td>\n                        <td className=\"text-right\"><Link to={`/play?torrent=${encodeURIComponent(torrent.magnet)}`} className=\"btn btn-outline-primary ti-control-play\"></Link></td>\n                    </tr>\n                </>)}\n            </tbody>\n        </Table>}\n    </Container>\n}\n","import React, { useEffect, useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport { format } from 'timeago.js'\n\nimport { TorrentMeta, getTorrents, getUsage, Usage } from '../helpers/client'\nimport { formatBytes } from '../helpers'\n\nexport function DashboardComponent(): JSX.Element {\n    const [torrents, setTorrents] = useState<TorrentMeta[]>()\n    const [usage, setUsage] = useState<Usage>()\n    const [error, setError] = useState('')\n\n    const updateTorrents = () => getTorrents().then(v => setTorrents(v)).catch(err => {\n        setError(String(err))\n    })\n    const updateUsage = () => getUsage().then(v => setUsage(v)).catch(err => {\n        setError(String(err))\n    })\n\n    useEffect(() => {\n        let torrentsInterval: NodeJS.Timeout\n        let usageInterval: NodeJS.Timeout\n\n        updateTorrents().then(() => {\n            torrentsInterval = setInterval(() => {\n                updateTorrents()\n            }, 5 * 1000)\n        })\n        updateUsage().then(() => {\n            usageInterval = setInterval(() => {\n                updateTorrents()\n            }, 60 * 1000)\n        })\n\n        return () => {\n            clearInterval(torrentsInterval)\n            clearInterval(usageInterval)\n        }\n    }, [])\n\n    return <div className=\"container\">\n        {error && <div className=\"alert alert-danger\" role=\"alert\">\n            {error}\n        </div>}\n        {!torrents && !error && <div className=\"text-center\">\n            <div className=\"spinner-border\" role=\"status\">\n                <span className=\"sr-only\">Loading...</span>\n            </div>\n        </div>}\n        {usage && <div className=\"card-deck mb-3 text-center\">\n            <div className=\"card mb-4 box-shadow\">\n                <div className=\"card-header\">\n                    <h4 className=\"my-0 font-weight-normal\">Disk space</h4>\n                </div>\n                <div className=\"card-body\">\n                    <h2 className=\"card-title pricing-card-title\">\n                        {formatBytes(usage.totalDiskSpace - usage.freeDiskSpace)}\n                        <small className=\"text-muted\">/ {formatBytes(usage.totalDiskSpace)}</small>\n                    </h2>\n                    <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{\n                            width: `${((usage.totalDiskSpace - usage.freeDiskSpace) / usage.totalDiskSpace * 100)}%`\n                        }}></div>\n                    </div>\n                </div>\n            </div>\n            <div className=\"card mb-4 box-shadow\">\n                <div className=\"card-header\">\n                    <h4 className=\"my-0 font-weight-normal\">Torrents space</h4>\n                </div>\n                <div className=\"card-body\">\n                    <h2 className=\"card-title pricing-card-title\">\n                        {formatBytes(usage.usedTorrentSpace)}\n                        <small className=\"text-muted\">/ {formatBytes(usage.freeDiskSpace + usage.usedTorrentSpace)}</small>\n                    </h2>\n                    <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{\n                            width: `${usage.usedTorrentSpace / (usage.freeDiskSpace + usage.usedTorrentSpace) * 100}%`\n                        }}></div>\n                    </div>\n                </div>\n            </div>\n        </div>}\n        {torrents && <>\n            {torrents.length ? <>\n                <table className=\"table\">\n                    <thead>\n                        <tr>\n                            <th>Name</th>\n                            <th>Download</th>\n                            <th>Created</th>\n                            <th>Play</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {torrents.map(torrent => <>\n                            <tr>\n                                <td>{torrent.name}</td>\n                                <td>{formatBytes(torrent.downloaded)} ({formatBytes(torrent.downloadSpeed)}/s)</td>\n                                <td>{format(torrent.started)}</td>\n                                <td><Link to={`/play?torrent=${encodeURIComponent(torrent.link)}`} className=\"btn btn-outline-primary ti-control-play\"></Link></td>\n                            </tr>\n                        </>)}\n                    </tbody>\n                </table>\n            </> : <div className=\"alert alert-warning\" role=\"alert\">\n                No active torrents at the moment\n            </div>}\n        </>}\n    </div>\n}","import React from 'react'\nimport { Link } from 'react-router-dom'\nimport { Switch, Route } from 'react-router'\n\nimport { HomeComponent } from './home'\nimport { PlayComponent } from './play'\nimport { BrowseComponent } from './browse'\nimport { DashboardComponent } from './dashboard'\n\nexport function ContentComponent(): JSX.Element {\n    return <div>\n            <div className=\"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow\">\n            <h5 className=\"my-0 mr-md-auto font-weight-normal\"><Link className='text-decoration-none text-dark' to='/'>Torrent Stream Server</Link></h5>\n            <nav className=\"my-2 my-md-0 mr-md-3\">\n                <Link className=\"p-2 text-dark\" to=\"/\">Home</Link>\n                <Link className=\"p-2 text-dark\" to=\"/browse\">Browse</Link>\n                <Link className=\"p-2 text-dark\" to=\"/dashboard\">Dashboard</Link>\n            </nav>\n                <a className=\"btn btn-outline-primary\" href=\"https://github.com/KiraLT/torrent-stream-server\" target=\"_blank\" rel=\"noopener noreferrer\">Find on GitHub</a>\n            </div>\n\n            <Switch>\n                <Route path=\"/\" component={HomeComponent} exact />\n                <Route path=\"/play\" component={PlayComponent} exact />\n                <Route path=\"/browse\" component={BrowseComponent} exact />\n                <Route path=\"/dashboard\" component={DashboardComponent} exact />\n            </Switch>\n    </div>\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { BrowserRouter } from 'react-router-dom'\n\nimport { ContentComponent } from './components/content'\nimport { register } from './serviceWorker'\n\nexport function initApp(target: HTMLElement | null): void {\n    registerWebworker()\n\n    ReactDOM.render(\n        <BrowserRouter>\n            <ContentComponent />\n        </BrowserRouter>,\n        target\n    )\n}\n\nfunction registerWebworker(): void {\n    register({\n        onUpdate: () => {\n            const div = document.createElement('div')\n            div.style.position = 'fixed'\n            div.style.bottom = '0'\n            div.style.left = '0'\n            div.style.right = '0'\n            div.style.zIndex = '9999'\n            div.style.textAlign = 'center'\n            div.style.background = 'rgba(208, 208, 208, 0.90)'\n            div.style.padding = '2px'\n            div.className = 'text-secondary'\n            div.innerHTML = `\n                New content is available and will be used when all tabs for this page are closed\n                <button class=\"btn btn-link\" onClick=\"this.parentNode.style.display = 'none'\">\n                    x\n                </button>`\n            document.body.appendChild(div)\n        }\n    })\n}\n","import { initApp } from './app'\n\ninitApp(document.getElementById('root'))\n"],"sourceRoot":""}